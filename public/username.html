<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>캐치! 보안핑</title>
  <style>
    /* 기존 스타일 유지 */
  </style>
  <script>
    window.onload = function() {
      const username = localStorage.getItem('username');
      if (username) {
        document.getElementById('username').innerText = username;
      } else {
        document.getElementById('username').innerText = '알 수 없는 사용자';
      }

      // 로컬 저장소에서 네트워크 항목을 불러와 동적으로 생성
      const networks = JSON.parse(localStorage.getItem('networks') || '[]');
      const iotSection = document.querySelector('.iot-section');

      networks.forEach(networkName => {
        const iotBox = document.createElement('div');
        iotBox.className = 'iot-box';
        iotBox.innerHTML = `
          <div class="dots" onclick="event.stopPropagation(); navigateToSettings('${networkName}')">⋮</div>
          <h3>${networkName}</h3>
        `;
        iotBox.onclick = () => navigateToItemPage(networkName);
        iotSection.appendChild(iotBox);
      });
    };

    function navigateToItemPage(itemName) {
      window.location.href = `/item-page.html?item=${encodeURIComponent(itemName)}`;
    }

    function navigateToSettings(itemName) {
      window.location.href = `/settings.html?item=${encodeURIComponent(itemName)}`;
    }

    function navigateToAddItem() {
      window.location.href = '/add-item.html';
    }
  </script>
</head>
<body>

  <!-- 기존 HTML 구조 유지 -->
  <div class="container">
    <div class="header">캐치! 보안핑</div>

    <div class="info-card">
      <h2>사용자 정보</h2>
      <p id="username">사용자 정보를 가져오는 중...</p>
      <p>등록된 IoT: <span id="registered-iot">0</span></p>
      <p>활성화된 IoT: <span id="active-iot">0</span></p>
    </div>

    <div class="iot-section">
      <div class="iot-box" onclick="navigateToItemPage('거실')">
        <div class="dots" onclick="event.stopPropagation(); navigateToSettings('거실')">⋮</div>
        <h3>거실</h3>
      </div>
      <div class="iot-box" onclick="navigateToItemPage('안방')">
        <div class="dots" onclick="event.stopPropagation(); navigateToSettings('안방')">⋮</div>
        <h3>안방</h3>
      </div>
      <div class="iot-box" onclick="navigateToItemPage('독서실')">
        <div class="dots" onclick="event.stopPropagation(); navigateToSettings('독서실')">⋮</div>
        <h3>독서실</h3>
      </div>
      <div class="iot-box" onclick="navigateToItemPage('회사')">
        <div class="dots" onclick="event.stopPropagation(); navigateToSettings('회사')">⋮</div>
        <h3>회사</h3>
      </div>
    </div>

    <div class="plus-button" onclick="navigateToAddItem()">➕ 항목 추가</div>
  </div>

</body>
</html>
